<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>客服工作台</title>
    <script src="https://cdn.shushubuyue.net/ajax/libs/tailwindcss/3.4.16/tailwind.min.js"></script>
  </head>
  <body class="h-screen w-screen overflow-hidden bg-slate-950 text-slate-100">
    <main class="relative h-screen w-screen">
      <section class="h-full w-full bg-slate-950">
        <webview
          id="support-webview"
          src="https://fc.gengleyuan.com/kefu/agent/"
          class="h-full w-full"
          preload="./webview-preload.js"
        ></webview>
      </section>
      <div class="pointer-events-none absolute left-4 top-4 z-10 flex gap-1 rounded-full border border-blue-500/30 bg-slate-950/70 p-0.5 shadow-lg backdrop-blur">
        <button
          id="refresh-btn"
          class="pointer-events-auto rounded-full border border-blue-500/30 bg-blue-500/10 px-2 py-0.5 text-[10px] font-medium text-blue-100 transition hover:border-blue-400/60 hover:bg-blue-500/20 hover:text-white"
          title="刷新"
        >
          刷新
        </button>
      </div>
    </main>
    <script>
      const supportWebview = document.getElementById("support-webview");
      const refreshBtn = document.getElementById("refresh-btn");
      refreshBtn?.addEventListener("click", () => {
        supportWebview.reload();
      });
      supportWebview?.addEventListener("ipc-message", (event) => {
        if (event.channel === "toast") {
          window.electronAPI?.notifyTest?.(event.args?.[0]);
        }
      });
      if (window.electronAPI?.onOpenSession) {
        window.electronAPI.onOpenSession((sessionId) => {
          if (sessionId) {
            supportWebview?.send("open-session", sessionId);
          }
        });
      }
    </script>
  </body>
</html>
